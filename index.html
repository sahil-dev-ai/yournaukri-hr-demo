Can you check for this app as well: <!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>YourNaukri App - Job Portal</title> <!-- Tailwind --> <script src="https://cdn.tailwindcss.com"></script> <style> body { font-family: "Inter", sans-serif; background-color: #f7f9fb; } .app-container { max-width: 600px; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05); } .job-card { transition: transform 0.2s, box-shadow 0.2s; } .job-card:hover { transform: translateY(-2px); box-shadow: 0 8px 15px rgba(0, 0, 0, 0.08); } .tag { border: 1px solid #d1d5db; color: #4b5563; } /* overlay loader spinner */ .spin { width: 3.5rem; height: 3.5rem; border: 4px solid rgba(255, 255, 255, 0.25); border-top-color: #3b82f6; border-radius: 9999px; animation: spin 1s linear infinite; } @keyframes spin { to { transform: rotate(360deg); } } </style> <script> tailwind.config = { theme: { extend: { colors: { "primary-blue": "#1E40AF", "light-blue": "#3B82F6", "background-gray": "#f7f9fb", }, }, }, }; </script> </head> <body class="min-h-screen flex items-start justify-center p-4 sm:p-6 bg-background-gray"> <div id="app-container" class="app-container w-full bg-white rounded-xl overflow-hidden mt-8"> <!-- Header --> <header class="p-4 border-b border-gray-100 flex justify-between items-center bg-white sticky top-0 z-10"> <h1 class="text-xl font-bold text-gray-800">YourNaukri App</h1> <div class="flex space-x-4 text-sm text-gray-500"> <!-- Manage Privacy: now HIDDEN until consent --> <button id="manage-privacy-link" class="hidden cursor-pointer hover:text-primary-blue disabled:opacity-40 disabled:cursor-not-allowed" disabled onclick="handleManagePrivacy()"> Manage Privacy </button> <span class="font-semibold text-gray-700">Welcome, Kiran</span> </div> </header> <!-- Main View --> <main id="content-view" class="p-4 sm:p-6"></main> <!-- Message Box --> <div id="message-box" class="fixed inset-0 bg-gray-600/50 hidden items-center justify-center z-50"> <div class="bg-white p-6 rounded-lg shadow-2xl w-11/12 max-w-sm"> <h3 id="message-title" class="text-lg font-semibold mb-3 text-gray-900"> Notification </h3> <p id="message-text" class="text-gray-700 mb-4"></p> <button onclick="closeMessage()" class="w-full bg-primary-blue text-white py-2 rounded-lg hover:bg-light-blue transition"> OK </button> </div> </div> <!-- Fullscreen Loader (used while calling consent APIs / opening SDK) --> <div id="loader" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50"> <div class="spin"></div> </div> </div> <script> /*********************** * CONSENT ‚Äì SETTINGS * ***********************/ // üëâ Old token function ‚Äì still used for Manage Privacy const TOKEN_URL = "https://consent-token-fetch.netlify.app/.netlify/functions/getToken"; // üëâ NEW: Combined backend (token + register) ‚Äì used for primary consent flow const CONSENT_REGISTER_URL = "https://consent-token-fetch.netlify.app/.netlify/functions/consent-register"; // üëâ Your Consent Profile Id (kept same as your previous demo) const CONSENT_PROFILE_ID = "6a3652e6-9604-4458-967f-22c9b2bdf304"; /* CHANGED: track consent per job */ let consentGiven = false; // overall flag (true if any job has consent) let principalId = null; // last CPID used for Privacy Center let consentByJob = {}; // { [jobId]: { given: boolean, principalId: string } } let selectedJob = {}; const VIEWS = { JOB_LIST: "job_list", JOB_DETAIL: "job_detail", APPLICATION_FORM: "application_form", CONFIRMATION: "confirmation", }; let currentView = VIEWS.JOB_LIST; const MOCK_JOBS = [ { id: 1, title: "Front-End Engineer", location: "Delhi", salary: "5-6LPA", type: "Full Time", description: "We are looking for a skilled Front-End Engineer to join our dynamic team. You will be responsible for implementing visual elements that users see and interact with in a web application. Excellent proficiency in HTML, CSS, JavaScript, and a modern framework (like React or Vue) is required.", }, { id: 2, title: "Graphic Designer", location: "Delhi", salary: "5-6LPA", type: "Full Time", description: "Seeking a creative Graphic Designer to develop engaging and user-friendly designs for digital and print media. Key responsibilities include creating visual concepts, using design software, and collaborating with marketing and product teams. Portfolio required.", }, { id: 3, title: "UX Specialist", location: "Remote", salary: "7-10LPA", type: "Part Time", description: "A remote opportunity for a UX Specialist to conduct user research, create wireframes and prototypes, and work with product managers to define and implement innovative solutions for product direction, visuals, and experience.", }, ]; /*********************** * UTIL & UI HELPERS * ***********************/ function showMessage(text, title = "Notification") { document.getElementById("message-title").textContent = title; document.getElementById("message-text").textContent = text; const box = document.getElementById("message-box"); box.classList.remove("hidden"); box.classList.add("flex"); } function closeMessage() { const box = document.getElementById("message-box"); box.classList.add("hidden"); box.classList.remove("flex"); } function showLoader(show = true) { const el = document.getElementById("loader"); if (show) { el.classList.remove("hidden"); el.classList.add("flex"); } else { el.classList.add("hidden"); el.classList.remove("flex"); } } function enableManagePrivacyButton() { // Now controls visibility (hidden until any job has consent) const btn = document.getElementById("manage-privacy-link"); const anyConsent = Object.values(consentByJob).some((v) => v?.given); consentGiven = anyConsent; // keep original flag meaning "some consent exists" if (anyConsent) { btn.classList.remove("hidden"); btn.disabled = false; } else { btn.classList.add("hidden"); btn.disabled = true; } } /*********************** * CONSENT ‚Äì CORE * ***********************/ async function loadCollectorSdkOnce() { if (window.LeegalityConsentCollector) return; await new Promise((resolve, reject) => { const s = document.createElement("script"); s.src = "https://sdk.consent.in/consent-collect-sdk.min.js"; s.onload = resolve; s.onerror = reject; document.body.appendChild(s); }); } // still used for Manage Privacy (update) async function getBearerToken() { const r = await fetch(TOKEN_URL); const j = await r.json(); if (!j || !j.access_token) throw new Error("Token fetch failed"); return j.access_token; } // NEW: Consent flow using backend combined function (token + register) async function handleConsent() { try { if (!selectedJob?.id) { showMessage("No job selected.", "Error"); return; } const jobId = selectedJob.id; showLoader(true); // Demo user's details (same as form) const name = "Kiran Kumar"; const email = "kirankumar@email.com"; const phone = "981271839123"; // Call backend: token + register from server-side const res = await fetch(CONSENT_REGISTER_URL, { method: "POST", headers: { "Content-Type": "application/json", }, body: JSON.stringify({ name, email, phone, consentProfileId: CONSENT_PROFILE_ID, consentProfileVersion: 1, }), }); const data = await res.json(); if (!res.ok) { console.error("Consent register backend error:", data); showLoader(false); showMessage( "Consent registration failed. Please try again.", "Error" ); return; } const url = data?.consentUrl; const cpid = data?.cpid || data?.principalId || null; // If no fresh URL, assume consent already exists for this demo CPID if (!url) { consentByJob[jobId] = { given: true, principalId: cpid }; if (cpid) { principalId = cpid; } enableManagePrivacyButton(); showLoader(false); renderApplicationForm(2); showMessage( "Consent already exists for this demo user. You can submit the application now.", "Consent" ); return; } // Load SDK & open await loadCollectorSdkOnce(); const collector = new window.LeegalityConsentCollector({ url }); collector.on("response", (resp) => { showLoader(false); if (resp?.type === "consentCollect.success") { consentByJob[jobId] = { given: true, principalId: cpid }; if (cpid) { principalId = cpid; } enableManagePrivacyButton(); // Re-render the same step to reflect success state & enable submit renderApplicationForm(2); showMessage( "Thanks! Your privacy preferences were saved.", "Consent accepted" ); } else if (resp?.type === "consentCollect.closed") { // user closed; keep page as-is } else { showMessage( "Consent is required to proceed with the application.", "Consent not completed" ); } }); collector.open(); } catch (e) { console.error(e); showLoader(false); showMessage( "Could not start consent flow. Please try again.", "Error" ); } } // Header: Manage Privacy (still uses getToken + update endpoint) async function handleManagePrivacy() { // Use the latest principalId (from most recent consent) if (!consentGiven || !principalId) { showMessage( "Please give consent during application first. Then you can manage privacy here.", "Manage Privacy" ); return; } try { showLoader(true); const token = await getBearerToken(); const res = await fetch( "https://sandbox-gateway.leegality.com/consent-runner/api/v1/consents/client/update", { method: "POST", headers: { Authorization: Bearer ${token}, "Content-Type": "application/json", }, body: JSON.stringify({ principalId, preferenceUrlType: "PRIVACY", publicUrlExpiry: 60, sessionExpiry: 60, }), } ); const j = await res.json(); const url = j?.data?.privacyCenterUrl; if (!url) throw new Error("No privacyCenterUrl"); await loadCollectorSdkOnce(); const collector = new window.LeegalityConsentCollector({ url }); collector.open(); showLoader(false); } catch (e) { console.error(e); showLoader(false); showMessage( "Could not open Privacy Center. Please try again.", "Error" ); } } /*********************** * VIEWS ‚Äì RENDERING * ***********************/ function renderJobList() { const content = document.getElementById("content-view"); content.innerHTML = <h2 class="text-2xl font-semibold mb-6 text-gray-800">Available Jobs</h2> <div class="space-y-4" id="job-list"> ${MOCK_JOBS.map( (job) => <div class="job-card p-4 border border-gray-200 rounded-xl bg-white flex flex-col sm:flex-row justify-between items-start sm:items-center"> <div> <h3 class="text-lg font-bold text-gray-900">${job.title}</h3> <div class="flex space-x-2 mt-2"> <span class="tag text-xs font-medium px-3 py-1 rounded-full">${job.location}</span> <span class="tag text-xs font-medium px-3 py-1 rounded-full">${job.salary}</span> <span class="tag text-xs font-medium px-3 py-1 rounded-full">${job.type}</span> </div> </div> <button onclick="viewJobDetail(${job.id})" class="mt-3 sm:mt-0 px-6 py-2 bg-primary-blue text-white rounded-lg hover:bg-light-blue transition shadow-md"> See job </button> </div> ).join("")} </div> ; currentView = VIEWS.JOB_LIST; } function viewJobDetail(jobId) { const job = MOCK_JOBS.find((j) => j.id === jobId); if (!job) { showMessage("Job not found.", "Error"); return; } selectedJob = job; const content = document.getElementById("content-view"); content.innerHTML = <button onclick="renderJobList()" class="mb-4 text-primary-blue hover:text-light-blue flex items-center"> <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor"> <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"/> </svg> Back to Jobs </button> <div class="bg-white p-6 rounded-xl border border-gray-100"> <h2 class="text-3xl font-bold mb-4 text-gray-900">${job.title}</h2> <div class="flex space-x-2 mb-6"> <span class="tag text-sm font-medium px-4 py-1 rounded-full">${job.location}</span> <span class="tag text-sm font-medium px-4 py-1 rounded-full">${job.salary}</span> <span class="tag text-sm font-medium px-4 py-1 rounded-full">${job.type}</span> </div> <h3 class="text-xl font-semibold mb-3 text-gray-800">Job Description</h3> <p class="text-gray-700 leading-relaxed whitespace-pre-wrap mb-8">${job.description}</p> <button onclick="renderApplicationForm(1)" class="w-full px-6 py-3 bg-primary-blue text-white rounded-lg hover:bg-light-blue transition text-lg font-semibold shadow-xl"> APPLY FOR THE JOB </button> </div> ; currentView = VIEWS.JOB_DETAIL; } function renderApplicationForm(step) { const content = document.getElementById("content-view"); const progress = <div class="flex justify-between items-center mb-6 text-sm font-medium"> <span class="${step === 1 ? "text-primary-blue font-bold" : "text-gray-500" }">1. Personal Info & Resume</span> <span class="${step === 2 ? "text-primary-blue font-bold" : "text-gray-500" }">2. Consent & Submit</span> </div> <div class="h-2 bg-gray-200 rounded-full mb-8"> <div class="h-2 bg-primary-blue rounded-full transition-all duration-500" style="width:${step === 1 ? "50%" : "100%" };"></div> </div> ; if (step === 1) { content.innerHTML = <h2 class="text-2xl font-bold mb-6 text-gray-900">Application for ${selectedJob.title}</h2> ${progress} <div class="space-y-6"> <div class="flex space-x-2 mb-6 text-gray-600 text-sm"> <span class="bg-gray-100 px-3 py-1 rounded-full">${selectedJob.location}</span> <span class="bg-gray-100 px-3 py-1 rounded-full">${selectedJob.salary}</span> <span class="bg-gray-100 px-3 py-1 rounded-full">${selectedJob.type}</span> </div> <div class="p-5 border border-gray-200 rounded-xl bg-white shadow-sm"> <h3 class="text-xl font-semibold mb-4 text-gray-800">1. Personal Info</h3> <div class="space-y-4"> <label class="block"> <span class="text-gray-700">Name</span> <input type="text" id="applicant-name" value="Kiran Kumar" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-blue focus:ring focus:ring-primary-blue focus:ring-opacity-50 p-2 border" readonly> </label> <label class="block"> <span class="text-gray-700">Email</span> <input type="email" id="applicant-email" value="kirankumar@email.com" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-blue focus:ring focus:ring-primary-blue focus:ring-opacity-50 p-2 border" readonly> </label> <label class="block"> <span class="text-gray-700">Mobile</span> <input type="tel" id="applicant-mobile" value="981271839123" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-blue focus:ring focus:ring-primary-blue focus:ring-opacity-50 p-2 border" readonly> </label> </div> </div> <div class="p-5 border border-gray-200 rounded-xl bg-white shadow-sm"> <h3 class="text-xl font-semibold mb-4 text-gray-800">2. Resume</h3> <p class="text-gray-600 mb-4">Current CV already uploaded. You can reupload an updated CV here.</p> <label for="cv-upload" class="cursor-pointer inline-block px-4 py-2 text-sm font-medium text-white bg-primary-blue rounded-lg hover:bg-light-blue transition"> Upload Updated CV </label> <input type="file" id="cv-upload" class="hidden"> <p class="mt-2 text-xs text-gray-500">File must be PDF or DOCX, max 5MB.</p> </div> <div class="p-5 border border-gray-200 rounded-xl bg-white shadow-sm"> <h3 class="text-xl font-semibold mb-4 text-gray-800">3. Salary Expectations</h3> <label class="block"> <span class="text-gray-700">Expected Annual Salary (in LPA)</span> <input type="number" id="expected-salary" placeholder="e.g., 7.5" min="0" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-blue focus:ring focus:ring-primary-blue focus:ring-opacity-50 p-2 border"> </label> </div> </div> <button onclick="renderApplicationForm(2)" class="w-full mt-8 px-6 py-3 bg-primary-blue text-white rounded-lg hover:bg-light-blue transition text-lg font-semibold shadow-xl"> Give data consent </button> <button onclick="viewJobDetail(${selectedJob.id})" class="w-full mt-4 text-gray-500 hover:text-gray-700"> Cancel </button> ; } else { const jobState = consentByJob[selectedJob.id] || { given: false }; content.innerHTML = <h2 class="text-2xl font-bold mb-6 text-gray-900">Application for ${selectedJob.title }</h2> ${progress} <div class="flex space-x-2 mb-8 text-gray-600 text-sm"> <span class="bg-gray-100 px-3 py-1 rounded-full">${selectedJob.location }</span> <span class="bg-gray-100 px-3 py-1 rounded-full">${selectedJob.type }</span> </div> <!-- Actual consent integration --> <div class="p-6 border border-primary-blue rounded-xl bg-blue-50 shadow-md"> <h3 class="text-xl font-semibold mb-4 text-primary-blue">Data Privacy Consent</h3> <p class="text-gray-700 mb-6"> Review and confirm your privacy preferences. We use your data (Name, Email, Mobile, CV) only for this application in line with our Privacy Policy. </p> ${jobState.given ? <p class="text-green-600 font-semibold">‚úÖ Consent collection successful</p> : <!-- PRIMARY STYLE (blue fill) --> <button onclick="handleConsent()" class="w-full px-5 py-3 rounded-lg bg-primary-blue text-white hover:bg-light-blue transition font-semibold"> Review & Give Consent </button> } <p class="mt-4 text-xs text-gray-500">Your preferences can be changed anytime via ‚ÄúManage Privacy‚Äù.</p> </div> <!-- SUBMIT disabled until this job's consent --> <button id="submit-btn" onclick="submitApplication()" class="w-full mt-8 px-6 py-3 rounded-lg text-white transition text-lg font-semibold shadow-xl ${jobState.given ? "bg-primary-blue hover:bg-light-blue" : "bg-gray-400 cursor-not-allowed" }" ${jobState.given ? "" : "disabled"}> Submit Application </button> <button onclick="renderApplicationForm(1)" class="w-full mt-4 text-gray-500 hover:text-gray-700"> Back to Personal Info </button> ; } currentView = VIEWS.APPLICATION_FORM; } function submitApplication() { const jobState = consentByJob[selectedJob.id]; if (!jobState || !jobState.given) { showMessage( "Please click ‚ÄúReview & Give Consent‚Äù before submitting your application.", "Consent required" ); return; } // mock submit UX const btn = [...document.querySelectorAll("button")].find( (b) => b.textContent.trim() === "Submit Application" ); if (btn) { btn.disabled = true; btn.textContent = "Submitting..."; btn.classList.add("opacity-50"); } setTimeout(renderConfirmation, 900); } function renderConfirmation() { const content = document.getElementById("content-view"); content.innerHTML = <div class="p-6 sm:p-10 bg-white rounded-xl text-center border border-green-200 shadow-lg"> <svg class="mx-auto h-16 w-16 text-green-500 mb-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /> </svg> <h2 class="text-3xl font-bold mb-3 text-green-600">Congratulations!</h2> <h3 class="text-xl font-semibold mb-6 text-gray-800"> Your application for ${selectedJob.title} has been successfully submitted. </h3> <p class="text-gray-600 mb-8 leading-relaxed"> HR will contact you soon regarding the next steps. You can revisit your privacy settings anytime via the header link. </p> <button onclick="renderJobList()" class="w-full px-6 py-3 bg-primary-blue text-white rounded-lg hover:bg-light-blue transition text-lg font-semibold shadow-xl"> Return to Job Listings </button> <p class="mt-4 text-sm text-gray-500"> <a href="https://www.consent.in/contact-us" target="_blank" class="underline">Contact Consentin</a> </p> </div> ; currentView = VIEWS.CONFIRMATION; } /*********************** * INIT * ***********************/ document.addEventListener("DOMContentLoaded", () => { renderJobList(); enableManagePrivacyButton(); }); </script> </body> </html>
